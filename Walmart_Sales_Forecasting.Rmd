---
title: "Walmart_Time_Series_Analysis"
output: pdf_document
date: "2022-11-15"
---

```{r}
# import dependencies

library(tidyr)
library(dplyr)
library(corrplot)
library(ggplot2)
```


# Importing the dataset
```{r}

walmart_df <- read.csv("Dataset/walmart-sales-dataset-of-45stores.csv")
walmart_df

walmart_df$Date <- as.Date(walmart_df$Date, format = "%d-%m-%Y")

# Seperating the Date
walmart_df[,"Year"] <- format(walmart_df[,"Date"],"%Y")
walmart_df[,"Month"] <- format(walmart_df[,"Date"],"%m")
walmart_df[,"Day"] <- format(walmart_df[,"Date"],"%d")

# Dataset dimension
dim(walmart_df)

#The dataset contains 6435 rows and 11 columns

#Checking null vales
colSums(is.na(walmart_df))

#The dataset contains no missing values

summary(walmart_df)
```
# Visualization

```{r}
par(mfrow=c(3,2))
hist(walmart_df$Temperature, col = 'light blue', main = "Temperature")
hist(walmart_df$Fuel_Price, col = 'light blue', main = "Fuel Price")
hist(walmart_df$CPI, col = 'light blue', main = "CPI")
hist(walmart_df$Unemployment, col = 'light blue', main = "Unemployment")
hist(walmart_df$Store, col = 'light blue', main = "Store Size")
hist(walmart_df$Weekly_Sales, col = 'light blue', main = "Weekly_Sales")

```


If our initial data does not fit the bell curve, we may log convert it to make it as "normal" as possible, enhancing the validity of the statistical analysis results. Our weekly sales data is clustered for the low weekly sales because it is skewed to the right. 


```{r}
hist(log(walmart_df$Weekly_Sales), col = 'blue',
     main = "weekly sales log transformed",
     xlab ='log(Weekly Sales)')

```


# Correlation Matrix 

```{r}
corr = cor(walmart_df[, c(3:8)])
corr

corrplot(corr, method = 'number')
```
There is a moderate positive correlation between sales, fuel price and holidays, and negative correlation between sales, unemployment, CPI, and temperature. 

# Weekly sales distribution in differnt month

```{r}
ggplot(walmart_df, aes(x = Month,y = Weekly_Sales )) + 
  geom_col() +
  facet_wrap(~Year) + 
  ggtitle("Weekly Sales Distribution in Different Months")
```




```{r}
ggplot(walmart_df, aes(x=Store, y=Weekly_Sales, color=Holiday_Flag)) +
  geom_point() 
```




```{r}
ggplot(walmart_df, aes(x = Store,y = Weekly_Sales )) + 
  geom_col() +
  facet_wrap(~Year) + 
  ggtitle("Weekly Sales Distribution in Different Stores")
```

Which stores have the most sells? 
```{r}

```



```

